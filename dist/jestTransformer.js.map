{"version":3,"sources":["../src/jestTransformer.js"],"names":["resolve","require","module","exports","process","jestTransformer","sourceText","sourcePath","config","options","source","replace"],"mappings":";;AAAA,MAAM,EAAEA,OAAF,KAAcC,QAAQ,MAAR,CAApB;;AAEAC,OAAOC,OAAP,GAAiB;AACfC,WAAS,SAASC,eAAT,CACPC,UADO,EAEPC,UAFO,EAGPC,MAHO,EAIPC,OAJO,EAKP;AACA,QAAIC,SAASJ,WAAWK,OAAX,CAAmB,MAAnB,EAA2B,KAA3B,EAAkCA,OAAlC,CAA0C,SAA1C,EAAqD,GAArD,CAAb;;AAEA,WAAQ;;;;uBAIWD,MAAO;;;;;wBAKNH,UAAW;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KAT/B;AAyCD;AAlDc,CAAjB","file":"jestTransformer.js","sourceRoot":"src","sourcesContent":["const { resolve } = require('path')\n\nmodule.exports = {\n  process: function jestTransformer(\n    sourceText,\n    sourcePath,\n    config,\n    options,\n  ) {\n    let source = sourceText.replace(/\\'/gm, \"\\\\'\").replace(/\\r?\\n/gm, ' ')\n\n    return `\n      let { resolve, extname } = require('path')\n      let { Schemata } = require('../../dist')\n\n      let content = '${source}'\n      let schemata = new Schemata(content)\n      let schema = schemata.schema\n      let astNode = schemata.ast\n      let resolvers\n      let filename = \"${sourcePath}\"\n      let jsFilename\n      let jsModule\n\n      try {\n        jsFilename = filename.replace(extname(filename), '.js')\n        jsModule = require(resolve(jsFilename))\n        resolvers = (\n          jsModule.resolvers || typeof jsModule == 'object' && jsModule\n        )\n      }\n      catch (error) {\n        console.error(error)\n\n        process.nextTick(() => {\n          delete require.cache[resolve(jsFilename)]\n        })\n\n        resolvers = null\n      }\n\n      schemata.resolvers = resolvers\n\n      module.exports = {\n        astNode,\n        default: schemata,\n        resolvers,\n        schema,\n        sdl: schemata,\n        typeDefs: schemata\n      }\n    `\n  }\n}"]}